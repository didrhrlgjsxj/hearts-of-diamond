게임 메카닉 설명
================================
최상급 부대 : 사단 여단 연대
전투단위 부대 : 대대 - 중대
중대는 대대의 수족역할을 하여 실제로 전투 중 위치에 따라 전투의 유불리가 바뀐다.

### 1. 부대 능력치 (Unit Stats)

모든 부대의 능력치는 가장 작은 단위인 분대(Squad)의 능력치를 합산하여 동적으로 결정됩니다.

*   **화력 (Firepower)**: 적의 단위방어력을 관통합니다. 부대가 실질적으로 얼마나 효과적으로 적을 공격할 수 있는지를 나타냅니다.
*   **대인 공격력 (Soft Attack)**: 장갑이 없거나 낮은 '소프트' 타겟(보병 등)에게 가하는 병력(주황색 바) 피해량을 결정합니다.
*   **대물 공격력 (Hard Attack)**: 장갑이 높은 '하드' 타겟(기갑 등)에게 가하는 병력 피해량을 결정합니다. 적의 장갑을 관통하는 데 사용됩니다.
*   **정찰력 (Reconnaissance)**: 적을 발견하는 능력입니다. 이 능력치가 높을수록 적을 더 멀리서 탐지할 수 있습니다. (현재는 `detectionRange`로 구현)
*   **내구력 (Strength)**: 부대의 HP와 같은 개념입니다. 이 수치가 0이 되면 부대는 파괴됩니다.
*   **장갑 (Armor)**: 적의 공격으로부터 부대를 보호하는 능력입니다. 특히 대인 공격력에 의한 피해를 크게 감소시키며, 대물 공격력에 의한 피해도 일부 막아냅니다. 상위 부대의 장갑 수치는 소속된 모든 분대의 장갑 평균값으로 계산됩니다. 대물 공격력이 장갑보다 낮을 경우, 비율에 따라 피해량이 감소합니다.
*   **조직력 (Organization)**: 부대의 전투 지속력을 나타냅니다. 조직력이 높거나 조직방어력이 높은 부대는 전투 시 받는 피해의 대부분을 흡수하여 내구력 손실을 최소화합니다. 조직력이 0이 되면 부대는 전투를 효율적으로 수행할 수 없으며, 받는 내구력 피해가 급증합니다. 전투 중에는 조직력 회복이 매우 느려집니다.
*   **기갑화율 (Hardness)**: 부대가 얼마나 '기갑화'되었는지를 나타내는 비율(0%~100%)입니다. 보병은 0%, 기갑은 100%에 가깝습니다. 공격자는 방어자의 기갑화율을 보고 대인/대물 공격력의 효율을 조절합니다.
*   **조직 방어력 (Organization Defense)**: 부대가 유기적인 움직임을 통해 얼마나 적의 공격을 효과적으로 막아낼 수 있는지를 나타냅니다. 화력에 의해 관통됩니다. 조직력의 피해 흡수율을 증가시킵니다.
*   **단위 방어력 (Unit Defense)**: 부대의 각 유닛들이 얼마나 적의 공격을 버텨낼 수 있는지에 따라 결정됩니다. 장갑과 화력에 의해 곗
*   **기동력 (mobility)**:부대의 기동력을 나타냅니다. 기동력이 높을 수록 실제 부대의 이동속도가 증가합니다.
---

### 2. 유닛 타입별 특성 (Unit Type Specializations)

모든 부대의 기본 구성 단위는 분대(Squad)이며, 각 분대는 고유한 타입을 가집니다.

*   **보병 (Infantry)**: 부대의 최대 조직력을 증가시켜 전투 지속력을 높입니다.
*   **정찰 (Recon)**: 정찰력이 높아 넓은 시야를 제공합니다.
*   **기갑 (Armor)**: 높은 장갑, 화력, 공격력을 모두 갖춘 강력한 유닛입니다.
*   **포병 (Artillery)**: 화력에  특화되어 있어 적의 조직방여력을 파괴하는 데 효과적입니다.
*   **공병 (Engineer)**: 대물 공격력이 보병보다는 높다.

---

### 3. 전투 및 피해 계산 시스템 (Combat & Damage Calculation)

전투는 턴(Turn) 기반으로 진행되며, 각 중대는 자신의 공격 주기(`attackCooldown`)마다 공격을 수행합니다.

1.  **공격력 계산**:
    *   공격자는 먼저 방어자의 `기갑화율`을 확인합니다.
    *   `대인 공격력`과 `대물 공격력`을 기갑화율에 맞춰 조합하여 '유효 공격력'을 계산합니다.
    *    최종 공격력을 계산할 때, 적의 장갑을 적용하기 전에 먼저 조직 방어력으로 공격력을 1차 감소시킵니다. (공격력 - 조직방어력 - 장갑)
    *    부대가 받는 조직력 피해를 계산할 때, 단위 방어력만큼 피해량을 감소시킵니다. (조직력 피해 - 단위방어력)
    *   '유효 공격력'에서 방어자의 `장갑` 수치를 빼서 최종 '총 공격력'을 결정합니다.

2.  **피해 분배 (조직력의 보호막 역할)**:
    *   방어자의 `조직력`은 보호막처럼 작동하여 '총 공격력'의 일정 비율을 흡수합니다. 이 흡수율은 조직력이 높을수록(최대 90%) 높고, 낮을수록(최소 10%) 낮아집니다.
    *   조직력이 흡수한 피해는 조직력(초록색 바)을 감소시킵니다.
    *   조직력이 흡수하지 못한 나머지 피해는 `내구력`(주황색 바)을 직접 감소시킵니다.
    *   대대의 조직 방어력과, 대대 전체의 조직력 비율을 사용하여 피해 흡수율을 계산합니다. 이를 각 중대에 동일하게 적용합니다. 기본적으로 모든 대대는 0.2의 값을 가집니다.

3.  **전투 유형**:
    *   **정면 전투 (빨간색 선)**: 두 중대가 서로를 공격 대상으로 지정한 경우입니다.
    *   **측면 전투 (파란색 선)**: 한 중대가 자신을 공격하지 않는 적을 일방적으로 공격하는 경우입니다.
    *   **자동 반격**: 측면 공격을 하던 중대가 다른 적에게 공격을 받으면, 자신을 공격하는 적이 사거리 내에 있을 경우 즉시 그 적을 향해 반격하여 정면 전투로 전환합니다.
    *   **
---

### 4. 부대 역할 및 시각적 표현 (Unit Roles & Visual Rules)

이 게임에서 부대는 역할에 따라 '지휘 부대'와 '전투 부대'로 나뉩니다. 모든 부대는 사각형 아이콘으로 표시되며, 아이콘의 배경색은 소속된 팀(블루/레드)을 나타냅니다.

*   **전투 부대 (Combat Unit)**: **중대**가 이 게임의 실질적인 전투 수행 단위입니다. 모든 공격, 방어, 피해 계산은 중대를 기준으로 이루어집니다
*   **   대대는 중대를 직접 조종
*   **  최상급 부대 (Command Unit)**: **사단(Division)**, **여단(Brigade)**, **연대(Regiment)**는 직접 전투를 수행하지 않는 지휘 부대입니다. 이들의 주된 역할은 하위 부대들을 하나의 단위로 묶어 관리하고, 소속된 부대들에게 지휘 보너스나 특수 능력(향후 추가될 기능)을 제공하는 것입니다.
    *   최상급 부대는 여러 목적(보병, 기갑, 포병 등)을 가진 대대들을 조합하여 편성할 수 있는 '컨테이너'와 같습니다.
    *   이러한 역할을 시각적으로 나타내기 위해, 지휘 부대의 아이콘은 **매우 반투명하게** 표시되어 실제 전투 부대와 명확히 구분됩니다.

### 5. 진형 시스템 (Formation System)

*   **심볼 유닛 중심**: 모든 대대급 이상의 부대는 심볼유닛으로 표현되며, 휘하 부대를 통솔한다.
*   **역할 기반 배치**: 휘하의 다른 부대들은 '전휘', '중위', '후위' 중 하나의 역할을 부여받습니다.
*   **기본 진형**: 지휘 부대에 이동 명령을 내리면, 심볼유닛이 목표 지점으로 이동하고 나머지 부대들은 심볼을 중심으로 자신의 역할에 맞는 기본 진형을 유지하며 자동으로 따라갑니다. 부대는 항상 특정 방향(이동 방향 또는 적 방향)을 바라봅니다.
*   **커스텀 진형**: 플레이어가 지휘 부대 휘하의 부대(예: 대대)를 직접 선택하여 이동시키면, 그 상위 부대는 '커스텀 진형' 상태가 됩니다. 이 상태에서는 부대들이 기본 진형으로 돌아가지 않고, 사용자가 수정한 상대적인 배치를 유지한 채로 함께 움직입니다.
*   **진형 복귀**: 상위 부대를 선택하고 '기본 진형으로 복귀' 버튼을 누르면, 모든 하위 부대들은 다시 기본 진형 위치로 재배치됩니다.

### 6. 후퇴 (RETREAT)

*   **조직력 고갈**: 모든 중대는 조직력이 0이되면 모 대대에게 후퇴하고, 재정비 상태를 참으로 만듦
*   **후퇴**: 중대는 후퇴 도중엔 공격하지 않음
*   **대대 따라다니기**: 재정비 상태가 참이라면 대대를 계속 따라다님
*   **재정비 부대 처리**: 재정비 중인 부대는 전투에 참여하지 않으며, 재정비가 긑나면 다시 전투에 참여함

### 7. 시각적 표현 (Visuals)

*   **규모별 크기 및 기호**: 부대의 규모(Echelon)가 클수록 아이콘의 크기가 커지며, 각 아이콘 위에는 부대의 규모를 나타내는 표준 군대 기호가 표시됩니다 (XX: 사단, X: 여단, ||: 대대, |: 중대 등).
*   **상태 표시**: 부대 아이콘 위의 주황색 바는 **내구력**을, 초록색 바는 **조직력**을 나타냅니다.



분대와 소대는 정보로서만 존재하는 템플릿 용도의 부대단위
실제로는 중대가 존재할 수 있는 최소 단위임

심볼유닛:
    그 부대의 정보를 담고있으며, ui의 역할을 함
    얘를 들어서 대대가 있으면 대대의 이동속도라는 능력치가 따로 있을텐데, 이를 심볼유닛이 가지고 있음 또한 대대에
    어느 중대들이 소속되있는지, 총 병력수가 얼마나인지 등등, 대대자체의 역할을 수행함.
    단, 심볼유닛은 절대로 실제로 존재하는 유닛이 아님. 그저 정보상으로 존재하고, 상징으로만 존재함.

부대:


    진형 : 전위, 중위, 후위(심볼유닛는 항상 후위 중앙)
            / 목표 0: 후퇴                   (우선순위 0)
            / 목표 1: 재정비(대대 따라다니기)(우선순위 0.5)
            / 목표 2: 플레이어의 직접 명령    (우선순위 1)
            //목표 3: 기본 진형 위치         (우선순위 10)
            // --- 중대(Company)

                // 목표 4: 진형 이탈 시 복귀  (우선순위 4)
                // 목표 5: 전투 효율성 극대화 (우선순위 7)

    본부중대 : 모든 대대 이상 부대는 본부 중대를 가짐. 본부 중대는 데이터상 편제상으로만 존재함


생산 : 
    경공업과 중공업으로 구성되어 있으며, 경공업은 라이트 특성을 가진 장비들, 중공업은 헤비 특성을 가진 장비를 생상하는것이 효과적이다.
    또한 경공업은 인력의 역할을 하는 경제단위를 주기적으로 많은 양 높이며, 중공업은 상대적으로 적은 양을 높인다.

    모든 주기적인 hour기준 생산은 3개의 hour주기중 하나에 랜덤으로 할당된다. 이로써 한 hour에 부담되는 연산을 1/3로 줄인다.
    경제단위의 생산은 hour기준이 아니라 day를 기준으로 한다. 

프로빈스 : 
    맵을 나누는 그리드가 몇개씩 뭉쳐서 프로빈스가 된다. 이는 지역이고 프로빈스를 기준으로 영토의 확장이 계산되며 자원 또한 프로빈스 단위로 계산된다.
    


전투 알고리즘:
    대대 휘하 중대 들은 지속적으로 자신의 전투 효율성을 최대화 시킬 수 있는 위치로 이동한다.

    중대는 적 중대를 공격해 피해를 입힌다.
    대대는 휘하 중대의 공격대상을 지정하고, 휘하 중대의 이동 목표지점을 지정한다.
    최상급 부대는 휘하 대대의 공격대상을 지정하고, 휘하 대대의 이동 목표지점을 지정한다.

    전투 효율성:
        모든 중대는 각각의 병과에 따라 위치에 따른 전투 효율성을 갖는다. 이는 또한 병과에 따른 중대의 역할(선봉, 전위등)에 따라서도 달라진다.


